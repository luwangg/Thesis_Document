\section{Overview}

Now that a significant background has been provided, the problem this thesis combats will be futher framed and defined.  This chapter outlines the proposed implementation of a receiver design, for wideband jammer scenarios and low-mobility situations.  An adaptive signal processing software solution for mitigating the effects of both intentional and unintentional jamming (including wideband jamming) through a combination of three techniques.  These include: antenna subset selection, spectral subtraction, and blind source separation (BSS), which work in conjuction with one another to extract specific transmissions from a mixture of intercepted wireless signals. The goal of the proposed solution, called BLInd Spectrum Separation (BLISS), is to enable reliable, high throughput, and robust end-to-end wireless communications, especially high capacity multimedia (voice, data, imagery) transmissions. In particular, the focus of the proposed work is the so-called ``disadvantaged user''.  These users are generally considered limited in transmission and processing power such as small-deck combatants, submarines, unmanned air vehicles (UAVs), dispersed ground units in urban and radio frequency (RF) challenged environments.\\

The BLISS solution integrates three well-known adaptive signal processing algorithms found in the open literature: antenna subset selection, spectral subtraction, and blind source separation. Each of these algorithms is employed within the BLISS framework in order to enable the process of extracting individual transmissions intercepted from several mixtures of wireless signals. Although blind source separation can readily extract transmissions under ideal conditions, the BLISS system is aimed at harsh spectral envirnorments consisting of many users and in some cases jamming devices. Therefore BSS will not provide adiquate signal separation for robust throughput.  Hence, the other two algorithms, spectral subtractions and antenna subset selection will aid in this effort.\\

In previous sections it has been understood that current anti-jamming techniques cannot compensate in deterministic wideband jamming scenarios.  These scenarios must be throughly understood before a practical solution can be provided.  For this thesis, the worst case scenario will be considered for the jamming device.  For simplification a narrowband jammer will be considered as an adversary, and the transceiving devices cannot frequency hop thus remaining on the same frequency as the jammer.  The jammer has an identical modulation scheme as the friendly tranceivers and the constellation is in phase.  Finally the jammer is assumed at a similar distance and transmit power as the friendly tranceiving devices.  Under these conditions the jammer is completely orthogonal and historically impossible to remove.\\

This chapter is broken down into several sections which include a system level overview, the hardware and software choosen, signal removal evaluation, the superimposed equalizer design, and the antenna subset selection work.  Each of the systems that makeup BLISS have different purposes and goals allowing them to tackle different problems that occur.  It is important to note that these systems are at differing stages of development due to the limited time and initial development put into these blocks.\\ 

\section{System}

To provide a more straight forward explaination of the BLISS system it is appropriate to provided a system level overview.  The system's original purpose was to remove the effects of narrow and wideband jamming.  It accomplishes this goal through a series of processing blocks and a selection block.  These blocks include: the antenna subset selection (AntSS) block, spectral subtraction block, and finally the blind source separation block.  The figure below shows the interconnections between these blocks and certain modification were made from the original design of the system due to practical constraints.  These changes will be brought fourth as the blocks themselves are discussed in detail. Since an external research group is responsible to the AntSS block, it will not be throughly discussed by this thesis, but its fundimental purpose will be examined.\\

INSERT BLOCK DIAGRAM OF OVERALL SYSTEM\\

The first step in the BLISS system is to pass through the AntSS block.  Physically this block is equipped with many antenna in groups of 4.  As the block title portrays a subset of these antennas will be selected and they will be passed on to the next block.  Precisely a \(2^_{M}-to-2^_{N}\) downselection from an array of receive antennas to a set of BLISS receiver inputs. Each individual AntSS board provides 4-to-2 antenna downselection through a set of RF switches.  The goal of AntSS is to provide spatial separation through an array of antennas maximizing the SNR of the wanted signal.  It is important to note that the antenna spacing must be adiquet to provide enough separation or independence, depending on the operating frequencies or wavelength of the signals themselves.  Once the appropriate antennas are selected two signals are to the spectral subtraction block.\\

The spectral subtraction block is next, which is used to removal known unwanted signal from the spectrum so the source separation block and work properly.  The original design of the spectral subtraction block is to use an existing audio technique of removing noise or signals in the frequency domain through a subtraction and smoothing technique.  This technique was discussed previously in the background section, therefore its historical literature will not be examined futher.  To enable removal of unwanted signals, the Spectral Subtraction block maintained a database of known power spectral densities (PSD) of common modulation schemes.  A recognition system would be implemented to automatic identification of the interfering signal and the block would simply subtract it out, through its already known estimate from its database.  Next the newly subtracted signal would be passed to the Source Separation System, where the signal would be unmixed.\\

The source separation block separates signals when only their mixtures are observed.  The operation is called blind, since the signal sources and mixing procedure are unknown to the receiver.  Under some conditions this constraint cannot be completely upheld.  This is true because the solutions needed to solve such an event become generally intractable.  An initial approach in this project was to use a technique called AMUSE (Algorithm for Multiple Unknown Signals Extraction)\cite{amuse}.  AMUSE works by first collecting an estimate of the covariance matrix of the received signal, computing the singular value decomposition of that covariance matrix, then performing several transforms on the received signal once the number of mixed received signals is known.  Then a covariance is calculated from these transformed received signals which are offset by some instance \tau, and a eigenvalue decomposition is done upon these covariances.  From this decomposition the singular values are used with the transform matrix and the received signal to provide an estimate of the wanted source signal.\\

\[ R_{y}=E[yy^{t}]\]
\[ z=Cy\]
\[ R_{z}=E[z(\tau)z(t-\tau)^{t}\]
\[\^{x}=V^{t}Cy\]

It is important to note that for simplicity the mixing matrix for the original proposed solution involving AMUSE is generally constructed as a linear time invariant (LTI) system.  There is some activity occuring with nonlinear mixing, but that was considered outside of the scope of this problem.\\

\section{Hardware and Software Platforms}

\section{Spectral Subtraction}

Now that the a formal system level approach has been presented, a more detailed understanding of the blocks themselves can be examined.  The goal of the spectral subtraction block is to removal signals to allow the blind source separation block to work properly.  As discussed previously signals would first need to be identified and then removed based on information supplied in a precompiled database of known signals.  The technique to remove such signals is called spectral subtraction, which primarily takes place in the frequency domain.  This approach only relys on known PSD's of the interfering signal.  Initially this technique seemed quite sound, but futher investigation proved otherwise.\\

Initial simulations were created to examine this spectral estimation technique at RF frequencies rather than the standard audio frequencies for which Spectral Subtraction is formally used.  Only two signals were used in these simulations, both utilized the same modulation scheme and pulseshaping filters.  The signals were chosen to be non-orthoganal, since when they are orthogonal The frequency of the interfering signal was varied, and so were the oversubtraction parameter \alpha and quantization floor \beta.  Through experimentation \alpha worked best at a value greater than 10, and \beta worked best between 0.05 and 0.2.  The graph below show the bit error rate (BER) as the interferer is shifted across the wanted signal in frequency.\\

INSERT GRAPH\\

As you can see this spectral subtraction technique operates extremely poor when the signal are overlapping at all.  The reason system performs well at large frequency shifts is due to the bandpass filter which is used before the signal is quantized.  The reason the result is poor is because the estimate is largely incorrect.  Since the subtraction only utilzes the PSD's of the signals, half of the information is completely ignored.  This results in a completely inaccurate estimate.  The problem with traditional Spectral Subtraction is that its results are subjectively evaluated, which isn't accurate enough in a digital communication system.  NEED MORE CITATION ABOUT SPECTRAL SUBTRACTION SUBJECTIVE TESTING\\

Since the initial simulations for traditional Spectral Subtraction proved inadiquated other optioned needed to be explored.  First though, the problem needed to be an analyzed further for better understanding, then the appropriate solution could be formulated.  
Since the interfering signal and the wanted signal are non-orthoganal to one another they will share dimensional space, in this case the signals are inphase with one another.  Therefore both planes real and imaginary must be considered.  Non-orthoganal signal removal is a common task in communication system, which is done primarily by equalizers.  Therefore an equalizer approach was considered next.\\

\subsection{Equalizer Approach}

The equalizer approach used in this Spectral Subtraction approach is a Least Means Square (LMS) equalizer, utilizing training data used in the front portion of each transmitted frame.  This a common equalizer used in practice, allowing for future translation into a realized implementation.  The LMS equalizer was also chosen for it robustness no noise, which is a weakness of such equalizers as the zero-forcing equalizer and requires no matrix inversion such as the Least Square (LS) equalizer.  For proof of concept the entire datastream is used as training data, which provides the best results of any given channel for an adaptive equalizer, since the maximum knowledge is gained about the channel for each frame received.  The results below show the BER as the signals pass over one another in frequency, similar to the previous evaluation using traditional Spectral Subtraction.\\
  
INSERT FIGURE OF LMS EQUALIZER APPROACH\\

As you can see the figure above, the equalizer approach doesn't provide any improve beyond the traditional Spectral Subtraction approach.  The problem with using traditional adaptive equalizers is that they can only be used with a comparative slowly fading channel.  Since knowledge learned from the training data can be applied at the earliest to the next frame, if the interference changes enough it can render the equalizer useless.  This rapidly changing spectrum or energy within the spectrum is unforunately a common characteristic of jammers.  Even though this approach failed it provided an important observation and incite into the requirements and scenarios in which jammers can be overcome.  For the sake of completeness an additional test was done with a small repeating sequence, smaller than the equalizer tap size, and as aspected the equalizer was able to overcome the interferer.\\

INSERT FIGURE OF SMALL SEQUENCE OVERCOME BY EQUALIZER\\

The important conclusion drawn from the previous experiment is that the when signals are orthogonal the receiver needs to be able to predict what data or energy is being transmismitted at a given time.  Therefore the jammer problem must be constained future.  As a result two jammer scenarios will be defined.  The first scenarios is that the jammer's modulated data or energy is completely known to the receiver and the second is that the data sequence repeats with period being small.  The larger the period the more resources the receiver will need to devote to its determination and evaluation.  The sequence being completely known to the jammer is a reasonable assumption; primarily if the jammer is friendly, as discussed previously in this thesis, then that knowledge can be readily available.\\

Now that the jammer scenarios have been defined further they can be evaluated.  The first will be when the data sequence of the jammer is completely known to the receiver.  The approach here will be to synchronize with the interfering signal, so the interferer will simply be subtracted off.  To synchronize the signals a mathematical tool called correlation will be used.  Correlation is a common tool used in synchronization in communication systems when looking for known symbols in a stream of data.  The equation for correlation, shown below, simply passes signals over one another, the resulting sequence creates peaks where the data is most correlated.\\

\[ (f\star g)[n] = summation f^{\star}[m]g[n+m]\] NEED CITATION\\

An example of two sequences being cross-correlated with one another can be seen below, with the peak being where the signal line up of share the most mutual information with one another.  Therefore from this data the location of the start of the interfers data can easily be located and removed.  A simulation was created with this design in mind, with a unique result.  Since the signals are frequency shifted over one another, when there frequencies match, it produces the best result, but as soon as they are offset, errors start to occur.  This can easily be compensated for using a complex exponential multiplied by either the received or catalogued waveform.  This will enduce a frequency shift cancelling out the shifting signal.\\

INSERT FIGURE OF known signal remove\\

This simulation was also repeated but this time was subtracted in the frequency domain.  The result produced near identical results.  Since using this approach requires two fourier transforms, into and out of the frequency domain, computationally it is much more involved and requires many more resources than the time domain approach.  If the data was already the frequency domain from some other process or signal processing technique then the frequency subtraction would be a viable option.\\

Now that a viable subtraction technique has been determined, the final implementation for the Spectral Subtraction block can be realized.  As discussed in the Hardware and Software Platform section of this thesis, GNU Radio was the first to be examined because of its realtime attributes.  This was quite an involved process requiring many weeks of trial and error.  The first implementation was entirely written in C++, which is the recommended language for signal processing blocks in GNU Radio.\\  

Since C++ within GNU differs from many modern programming styles a code implementation or route was taken to ensure accuracy and speed up development.  Therefore all coding was done with C++ itself, using no GNU Radio built-in libraries\cite{gnuradioCPP}.  To allow for matrix operations the Aramdillo C++ Library\cite{armadillo} was imported and provided needed vector operations such as correlation and faster mathematical functions instead of having to rewrite common search operations.  This library would also be needed for the Signal Separation block, therefore coding with Armadillo would provide the knowledge for future implementations needed in that block.  From the standard C++ implementation results were compared with Matlab, and the code was ported into GNU Radio.\\

Standard C++ -> GNU Radio Simulations -> GNU Radio Hardware Final\\

GNU Radio C++ are basically written by first creating test cases and writing your code until they are solved.  This is a common practice among the programming community and provides a definitive endpoint to the code itself.  The code was written and compiled successfully but unforunately the python wrapper called SWIG\cite{swig}, which GNU Radio uses to interact with the C++ block through python, was unable to export the library.  This is an undocumented problem within GNU Radio and was only identified through discussions directly with the GNU Radio core development team.  Therefore another approach had to be considered.\\

The next option was to use python itself for signal processing.  This is approach was primarily developed by Josh Blum, one of the core developer of GNU Radio.  It isn't recommended due to speed issue, but it is quite easier to implement and debug for those familiar with python.  As a result the previously C++ code was ported to python standards libraries and then to GNU Radio.  The NumPy libraries were used within python.  NumPy is the fundimental package for scientific computing in Python\cite{numpy}.  It like the armadillo library provides matrix operations such as correlation.  Again under the Python standard libraries with NumPy the results were varified with MATLAB.  Then the code was port to GNU Radio.\\

Again more problems occured, stonewalling all progress.  The signal processing block was written as a subprocess using the queuing system built into GNU Radio.  Queueing provides barriers between the connected blocks; therefore they can run freely, limiting bottlenecks. The system built would operate correctly for several hundred samples but would eventually segmentation fault.  Several attempts to fix this error with even architectural changes to the code.  Finally the lead developer of GNU Radio was consulted, Tom Rondeau \cite{tomrondeau}, but he was also unable to determine a solution.  The assumed problem was a type casting occuring within the queue itself, that would eventually accumulate and cause a segmentation fault.\\

With these setbacks, I became necessary to look beyond GNU Radio and just utilize MATLAB for signal processing.  Therefore the decision to load captured signals from GNU Radio and process them in MATLAB.  It is nowhere near realtime, but it will process the data appropriately.  The simple GNU Radio needs frontend is important because it allows tight synchronization between multiple receive antenna, which is a require of the original design of the system.  The GNU Radio model can be seen in the figure below.\\

GNU RADIO RECEIVE MODEL from GRC\\

\subsection{Non-deterministic Scenarios}

For completeness it is important to discuss the scenarios when the interferer's modulated data is unknown but repetative with a small period.  The approach to estimating short sequences is a rather obvious one, an autoregressive algorithm is used to predict samples.  The simulation here, which was just used for proof of concept, uses a linear predictive filter.  The filter determines coefficients of a forward linear predictor by minimizing the prediction error in the least squares sense\cite{lpcfilter}.  It finds the coefficients of a pth-order linear predictor (FIR filter) that predicts the current value of the real-valued time series x based on past samples.

\[ \^{x}[n]=-a(2)x(n-1)-a(3)x(n-2)-...-a(p+1)x(n-p)\]

For the linear predictive filter to operate efficently the number of filter taps must be equal to or greater than the period of the repeated sequence.  If the number of taps is smaller it cannot capture the randomness the in the interferer's data.\\

\section{Superimposed Equatizer}

Moving on, the next block to discuss is the signal separation block.  The development of this block is very staggered and due to time requirements shortcuts needed to be made.  The original desired result was to use a blind source separation technique outlined here \cite{AMUSE}, which is able to separate multiple signals from one another under specific constraints.  For this process to work efficently an appropriate channel model needs to be created.  Since the goal of this system is to be very robust an estimator for very frequency selective channel is desired.  The progession of the signal separation block will be examined in this sections and the limitations will be discussed.\\

The first objective is to examine the channel mixing model which assumes a single-input multiple-antenna broadcast channel.  A J-channel FIR system excited by K transmit antennas is considered. A quasi time-invariant multipath channel is assumed which remains constant during the transmission of a set of consecutive symbols, which are called slots. These slots are assumed independent from one another.  The channel estimation is performed over each slot. Each symbol inside a slot is assumed to be the result of a known redundant precoder acting on an input transmit symbol vector drawn from an M-PSK constellation. Therefore the receiver receives signals not only from the intended transmitter but also from Q other interferers. The interferers are assumed to employ the same redundant precoder as the desired signal\cite{skrkantPHD}.\\

With this model, \cite{midterm_report} shows that at no assumptions are necessary regarding the number of the transmit antennas of each of the interferers and the channel orders as long as they are smaller than the block size.  The block size in this case is equal to the combination of the individual channel lengths and the number of transmit antenna used by the desired transmitter.  But this evaluation rely on three assumptions:\\

1. The data sequence x_{d} is an i.i.d. sequence such that \(x_{d}~CN(0,\sigma_{d}^{2}\)

2. The distribution over the MIMO channel vector is \(p(y;\theta)~CN(\mu_{y},R_{w})\), and the interference vector is distrbuted normal with covariance \(R_{w}\)

3. The transmitted symbols, the channel vector, and the interference vector are jointly independent

With these assumptions the mixing process can be undone but the channel estimation needs to be calculated first.  Since this is a MIMO channel, frequency selective fading will need to be captured to providing appropriate channel knowledge.  To accomplish list, using a superimposed equalizer was chosen, whose operation was heavily discussed in the background section of this thesis.  In summary, \cite{Ghogho} uses a superimposed symbol transmission scheme to estimate frequency-selective channels. Several points of the DFT of the data are set to known values. This operation can be easily implemented in the time domain when these DFT points are equispaced. The channel is estimated using the DFT of the received signal at these selected DFT points. The detection itself is done using an iterative method across these points.  Unlike traditional equalizers, the proposed method does not require bandwidth for training.  It instead trades spectral power for those symbols themselves, spreading its energy over the entire bandwidth capturing the entire spectrum space.   \cite{Ghogho} also proves that by placing the training symbols in quasi-periodic position they will not interfer with the data itself.\\

With our channel estimation method chosen, a simulation was created to prove the effectiveness of such a scheme.  The result of this implementation were directly compared with the results of the paper to prove correctness.  The results of this simulation are seen below.  It examines a random frequency selective channel, with very high suppression with a across a number of SNR values.  As expected there is a linear relationship between SNR.  For completeness a comparision was done with a traditional LMS equalizer to show the effectiveness of the superimpose equalizer.\\

INSERT Figure of SNR and channel estimate for Superimpose equalizer\\

INSERT Figure with comparision of superimposed equalizer vs. traditional linear equalizer\\


\section{Antenna Subset Selection}


\section{Summary}
